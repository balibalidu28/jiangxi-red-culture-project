<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理后台</title>
    <link rel="stylesheet" href="/static/css/admin/admin.css">
</head>
<body>
<div class="sidebar">
    <div class="sidebar-header">管理后台</div>
    <ul class="sidebar-nav">
        <li class="active" data-target="heroes">英雄管理</li>
        <li data-target="stories">故事管理</li>
        <li data-target="scenicspots">圣地管理</li>
        <li data-target="explore">活动管理</li>
        <li data-target="encyclopedias">百科管理</li>
        <li data-target="user">用户管理</li>
    </ul>
</div>

<div class="content">
    <!-- 英雄管理模块 -->
    <section id="heroes" class="module-section active">
        <h2>英雄管理</h2>
        <button onclick="showHeroForm()">新增英雄</button>

        <!-- 新增/编辑英雄表单 -->
        <div id="heroFormContainer" class="form-container" style="display: none;">
            <h2 id="heroFormTitle">新增英雄</h2>
            <form id="heroForm">
                <!-- 隐藏的ID字段 -->
                <input type="hidden" id="heroId">

                <div class="form-grid">
                    <div>
                        <label for="hero-name">姓名：</label>
                        <input type="text" id="hero-name" placeholder="请输入英雄姓名" required>
                    </div>

                    <div>
                        <label for="hero-alias">别名：</label>
                        <input type="text" id="hero-alias" placeholder="请输入别名">
                    </div>

                    <div>
                        <label for="hero-title">称号/职务：</label>
                        <input type="text" id="hero-title" placeholder="请输入称号或职务">
                    </div>

                    <div>
                        <label for="hero-category">类别：</label>
                        <select id="hero-category" style="width: 100%; padding: 5px;">
                            <option value="">请选择类别</option>
                            <option value="革命家">革命家</option>
                            <option value="军事家">军事家</option>
                            <option value="烈士">烈士</option>
                            <option value="领导人">领导人</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>

                    <div>
                        <label for="hero-gender">性别：</label>
                        <select id="hero-gender" style="width: 100%; padding: 5px;">
                            <option value="">请选择性别</option>
                            <option value="男">男</option>
                            <option value="女">女</option>
                        </select>
                    </div>

                    <div>
                        <label for="hero-ethnicity">民族：</label>
                        <input type="text" id="hero-ethnicity" placeholder="请输入民族">
                    </div>

                    <div>
                        <label for="hero-birthDate">出生日期：</label>
                        <input type="date" id="hero-birthDate" style="width: 100%; padding: 5px;">
                    </div>

                    <div>
                        <label for="hero-deathDate">逝世日期：</label>
                        <input type="date" id="hero-deathDate" style="width: 100%; padding: 5px;">
                    </div>
                </div>

                <div style="margin-top: 10px;">
                    <label for="hero-birthplace">籍贯：</label>
                    <input type="text" id="hero-birthplace" placeholder="请输入籍贯" style="width: 100%; padding: 5px;">
                </div>

                <div style="margin-top: 10px;">
                    <label for="hero-politicalStatus">政治面貌：</label>
                    <input type="text" id="hero-politicalStatus" placeholder="请输入政治面貌" style="width: 100%; padding: 5px;">
                </div>

                <div style="margin-top: 10px;">
                    <label for="hero-description">简介：</label>
                    <textarea id="hero-description" placeholder="请输入英雄简介" style="width: 100%; padding: 5px;"></textarea>
                </div>

                <div style="margin-top: 10px;">
                    <label for="hero-content">详细事迹：</label>
                    <textarea id="hero-content" placeholder="请输入详细事迹内容" style="width: 100%; padding: 5px;" rows="4"></textarea>
                </div>

                <div style="margin-top: 10px;">
                    <label for="hero-image">上传图片：</label>
                    <input type="file" id="hero-image" accept="image/*">
                    <!-- 当前图片回显+点击大图弹窗 -->
                    <div id="hero-current-image-box" style="display:none; margin-top:10px;">
                        <span style="margin-right:8px;">当前图片：</span>
                        <img
                                id="hero-current-image"
                                alt="当前英雄图片"
                                style="max-width:120px; vertical-align:middle; cursor:pointer; border-radius:4px; border:1px solid #ececec;"
                                onclick="if(this.src) previewImage(this.src, document.getElementById('hero-name').value||'英雄图片');"
                        >
                    </div>
                    <input type="hidden" id="heroImageUrlHidden">
                </div>

                <div style="margin-top: 15px;">
                    <button type="button" onclick="saveHero()">保存</button>
                    <button type="button" onclick="hideHeroForm()">取消</button>
                </div>
            </form>
        </div>

        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>姓名</th>
                <th>别名</th>
                <th>类别</th>
                <th>性别</th>
                <th>简介</th>
                <th>图片</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>
    </section>

    <!-- 故事管理模块 -->
    <section id="stories" class="module-section">
        <h2>故事管理</h2>
        <button onclick="showStoryForm()">新增故事</button>
        <!-- 新增/编辑故事表单 -->
        <div id="storyFormContainer" class="form-container" style="display:none;">
            <h2 id="storyFormTitle">新增故事</h2>
            <form id="storyForm">
                <input type="hidden" id="storyId">

                <label for="story-title">标题：</label>
                <input type="text" id="story-title" placeholder="请输入故事标题" required>

                <label for="story-content">内容：</label>
                <textarea id="story-content" placeholder="请输入故事正文" rows="4" required></textarea>

                <label for="story-source">来源：</label>
                <input type="text" id="story-source" placeholder="请输入来源">

                <label for="story-summary">摘要：</label>
                <input type="text" id="story-summary" placeholder="请输入故事摘要">

                <label for="story-storyTime">故事时间：</label>
                <input type="text" id="story-storyTime" placeholder="如 1935年/夏等">

                <label for="story-location">地点：</label>
                <input type="text" id="story-location" placeholder="请输入故事地点">

                <label for="story-heroName">英雄名称：</label>
                <input type="text" id="story-heroName" placeholder="请填写相关英雄姓名或留空">

                <label for="story-image">上传图片：</label>
                <input type="file" id="story-image" accept="image/*">
                <!-- 当前图片预览（仅编辑时显示） -->
                <div id="story-current-image-box" style="display:none; margin-top:10px;">
                    <span style="margin-right:8px;">当前图片：</span>
                    <img
                            id="story-current-image"
                            alt="当前故事图片"
                            style="max-width:120px; vertical-align:middle; cursor:pointer; border-radius:4px; border:1px solid #ececec;"
                            onclick="if(this.src) previewImage(this.src, document.getElementById('story-title').value||'故事图片');"
                    >
                </div>
                <input type="hidden" id="storyImageUrlHidden">

                <button type="button" onclick="saveStory()">保存</button>
                <button type="button" onclick="hideStoryForm()">取消</button>
            </form>
        </div>
        <table id="storyTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>标题</th>
                <th>摘要</th>
                <th>地点</th>
                <th>时间</th>
                <th>图片</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>
    </section>

    <!-- 圣地管理模块 -->
    <section id="scenicspots" class="module-section">
        <h2>圣地管理</h2>
        <button onclick="showScenicForm()">新增圣地</button>

        <!-- 新增/编辑圣地表单 -->
        <div id="scenicFormContainer" class="form-container" style="display: none;">
            <h2 id="scenicFormTitle">新增圣地</h2>
            <form id="scenicForm">
                <!-- 隐藏的ID字段 -->
                <input type="hidden" id="scenicId">
                <!-- 隐藏：原图片地址（编辑时用于保留旧图） -->
                <input type="hidden" id="scenicImageUrlHidden">

                <label for="scenic-name">名称：</label>
                <input type="text" id="scenic-name" placeholder="请输入圣地名称" required>

                <label for="scenic-location">地点：</label>
                <input type="text" id="scenic-location" placeholder="请输入圣地地点" required>

                <label for="scenic-description">简介：</label>
                <textarea id="scenic-description" placeholder="请输入圣地简介"></textarea>

                <!-- 文件上传（可选；当前未实现上传逻辑，仅保留控件） -->
                <label for="scenic-image">上传图片：</label>
                <input type="file" id="scenic-image" accept="image/*">

                <!-- 当前图片（仅编辑时显示；点击表格缩略图用弹窗预览） -->
                <div id="scenic-current-image-box" style="display:none; margin-top:8px;">
                    <span style="display:inline-block; margin-right:8px;">当前图片：</span>
                    <a id="scenic-current-image-link" href="#" target="_blank" rel="noopener noreferrer">
                        <img id="scenic-current-image" alt="当前图片" style="max-width:160px; vertical-align:middle;">
                    </a>
                </div>

                <div class="form-actions" style="margin-top:12px;">
                    <button type="button" onclick="saveScenic()">保存</button>
                    <button type="button" id="cancelScenicBtn" onclick="hideScenicForm()">取消</button>
                </div>
            </form>
        </div>

        <table id="scenicTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>名称</th>
                <th>地点</th>
                <th>简介</th>
                <th>图片</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>
    </section>

    <!-- 活动管理模块 -->
    <section id="explore" class="module-section">
        <h2>活动管理</h2>
        <button onclick="showExploreForm()">新增活动</button>
        <!-- 新增/编辑活动表单 -->
        <div id="exploreFormContainer" class="form-container" style="display: none;">
            <h2 id="exploreFormTitle">新增活动</h2>
            <form id="exploreForm">
                <!-- 添加这行：隐藏的ID字段 -->
                <input type="hidden" id="exploreId">

                <label for="explore-name">活动名称：</label>
                <input type="text" id="explore-name" placeholder="请输入活动名称" required>

                <label for="explore-location">地点：</label>
                <input type="text" id="explore-location" placeholder="请输入活动地点" required>

                <label for="explore-date">日期：</label>
                <textarea id="explore-date" placeholder="请输入活动日期"></textarea>

                <button type="button" onclick="saveExplore()">保存</button>
                <button type="button" onclick="hideExploreForm()">取消</button>
            </form>
        </div>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>活动名称</th>
                <th>日期</th>
                <th>地点</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>

    </section>

    <!-- 百科管理模块 -->
    <section id="encyclopedias" class="module-section">
        <h2>百科管理</h2>
        <button onclick="showEncyclopediaForm()">新增百科</button>
        <!-- 新增/编辑百科表单 -->
        <div id="encyclopediaFormContainer" class="form-container" style="display: none;">
            <h2 id="encyclopediaFormTitle">新增百科</h2>
            <form id="encyclopediasForm">
                <!-- 添加这行：隐藏的ID字段 -->
                <input type="hidden" id="encyclopediaId">

                <label for="encyclopedia-name">词条标题：</label>
                <input type="text" id="encyclopedia-name" placeholder="请输入词条标题" required>

                <label for="encyclopedia-location">内容：</label>
                <input type="text" id="encyclopedia-location" placeholder="请输入百科介绍" required>

                <label for="encyclopedia-image">上传图片：</label>
                <input type="file" id="encyclopedia-image" accept="image/*">

                <button type="button" onclick="saveEncyclopedia()">保存</button>
                <button type="button" onclick="hideEncyclopediaForm()">取消</button>
            </form>
        </div>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>词条标题</th>
                <th>内容</th>
                <th>图片</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>

    </section>
    <!-- 用户管理模块 -->
    <section id="user" class="module-section">
        <h2>用户管理</h2>
        <button onclick="showUserForm()">新增用户</button>

        <!-- 新增/编辑用户表单 -->
        <div id="userFormContainer" class="form-container" style="display: none;">
            <h2 id="userFormTitle">新增用户</h2>
            <form id="userForm" onsubmit="event.preventDefault(); saveUser();">
                <!-- 隐藏的ID字段（用于编辑模式） -->
                <input type="hidden" id="userId">

                <label for="username">用户名：</label>
                <input type="text" id="username" placeholder="请输入用户名" required>

                <label for="phone">手机号：</label>
                <input type="tel" id="phone" placeholder="请输入手机号" maxlength="11" required>

                <label for="password">密码：</label>
                <input type="password" id="password" placeholder="请输入密码" required>

                <label for="confirmPassword">确认密码：</label>
                <input type="password" id="confirmPassword" placeholder="请再次输入密码" required>

                <label for="role">角色：</label>
                <select id="role">
                    <option value="USER">USER</option>
                    <option value="ADMIN">ADMIN</option>
                </select>

                <label for="isActive">是否启用：</label>
                <select id="isActive">
                    <option value="true" selected>启用</option>
                    <option value="false">禁用</option>
                </select>

                <div class="form-actions">
                    <button type="submit">保存</button>
                    <button type="button" onclick="hideUserForm()">取消</button>
                </div>
            </form>
        </div>

        <table id="userTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>用户名</th>
                <th>手机号</th>
                <th>角色</th>
                <th>启用</th>
                <th>创建时间</th>
                <th>更新时间</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <!-- 动态填充 -->
            </tbody>
        </table>
    </section>
    <!-- 图片预览弹窗（不跳转，带关闭按钮） -->
    <div id="imagePreviewModal" class="image-preview-modal" onclick="if(event.target===this) closeImagePreview()">
        <div class="image-preview-content">
            <div class="image-preview-header">
                <span id="previewTitle">图片预览</span>
                <button class="image-preview-close" type="button" onclick="closeImagePreview()">&times;</button>
            </div>
            <div class="image-preview-body">
                <img id="previewImage" src="" alt="预览图片">
            </div>
        </div>
    </div>
</div>

<script src="/static/js/admin/admin.js"></script>
<script src="/static/js/admin/common.js"></script>
<script src="/static/js/admin/hero.js"></script>
<script src="/static/js/admin/scenic-spot.js"></script>
<script src="/static/js/admin/encyclopedia.js"></script>
<script src="/static/js/admin/explore.js"></script>
<script src="/static/js/admin/story.js"></script>
<script src="/static/js/admin/user.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        loadScenicSpots();
    });
</script>
</body>
</html>